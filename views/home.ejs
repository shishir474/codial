<!-- <html>
    <head>
        <title>
            <%= title %>
        </title>
        
    </head>
    <body>
        <h1>Codial / <%= title%> </h1>
    </body>
</html> -->


<!-- Understanding Partials -->
<html>
    <head>
        <title></title>
    </head>
    <body>
        
        <!-- <%- include('_header') %>  header and footer are already included in layout so thereby removing it  -->
        <h1>Codial/home page</h1>
        <section id="feed-posts">
            <h4>Posts</h4>
            <!-- display form only if the user is authenticated. If authenticated then locals objecty will have user key -->
            <% if (locals.user) { %>
                <!-- post form -->
            <form action="/posts/create" id="new-post-form" method="POST">
                <textarea name="content" cols="30" rows="3" placeholder="Type here..."></textarea>
                <input type="submit" value="Post">
            </form>
            
            <% } %>

        </section>
        
       
        <ul>
            <!-- displaying posts of a user -->
            <% for (post of posts){ %>
               <li>
                   <p>
                    <%= post.content%>
                    <br>
                    <small><%= post.user.name %></small>
                   </p>
                       <!-- comment form -->
                       <div id="post-comment">
                        <%  if (locals.user){ %>
                            <form action="/comment/create" id="new-comment-form" method="POST">
                                <input type="text" name="content" placeholder="Type Here to add comment...">
                                <!-- sending id of the post to which the comment belongs to in a hidden manner -->
                                <input type="hidden" name="post" value="<%= post._id%>">
                                <input type="submit" value="Add comment">
                            </form>
                            <% } %>  

<!-- 
                            displaying comments and author name
                            prepopulated the comments and user -->
                            <div id="post-comments-list">
                                <ul id="post-comments-<%= post._id %>">
                                    <% for (comment of post.comments) { %>
                                        <p>
                                            <%= comment.content %>
                                            <br>
                                            <small>
                                                <%= comment.user.name%>
                                            </small>
                        
                                        </p>


                                    <% } %>
                                </ul>
                            </div>
        
                       </div>
                  


                   
               </li>
            <%}%>
        </ul>


        <!-- <%- include('_footer')%> -->
    </body>
</html>